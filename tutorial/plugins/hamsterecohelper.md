# HamsterEcoHelper 插件指南

HamsterEcoHelper（仓鼠症插件）是为促进服务器经济流动的辅助性插件。

源码、文档及反馈 [戳这里](https://github.com/NyaaCat/HamsterEcoHelper)。

!> 最近，HamsterEcoHelper 进行了一次重构，大量命令的使用方法发生了变化，且可能依然存在一些问题。请诸位积极反馈自己遇到的问题。

!>**注意：如果购买/拍到物品时背包已满，物品将会保存至末影箱中，末影箱已满将会保存至临时储存，需要使用 `/hstorage` 查看、获取物品。**

:notebook_with_decorative_cover: HEH 相关命令具有多种拼写方法，功能完全一致。以访问天喵商城为例：
- `/hamsterecohelper market`
- `/heh market`
- `/h m`
- `/hm`

**以下如无特殊说明，均采用最简短的用法。**

--------

## 世界商店

在喵窝，世界商店称为「天喵商城」。在世界任意角落可随时访问。

?> :shopping_cart: **浏览及购买商品**

命令 `/hm` 可打开天喵商城；  
点击物品可购买一个，按住 Shift 单击则购买整格物品。

如果该商品来自本人，点击它将会下架。

?> :moneybag: **出售物品**

使用 `/hm [单价]`，可将手中物品**全部**上架至天喵商城。  
小贴士：

- 玩家可占用天喵商城的**最多 6 个**物品槽。
- 每次上架均征收摊位费 **100 节操**。
<!-- - 每占用一个物品槽，每日额外征收保管费 1 节操。 -->
- 每笔交易加收 10% 消费税。

!> 天喵商城托管费用将进行调整，目前暂时免费。请密切关注管理组的通知。

--------

## 木牌商店

有了木牌商店，经商变得简单自由。其结合了三大优势：
- **线下商店**——较低的税率、无额外费用；
- **功能更多**——满足销售、收购、抽奖等需求；
- **云同步技术**——同类型木牌内容，全服同步。在家中即可远程维护所有分店。

!> **规则与限制**

- “开店须知”请见[经济规则](nyaa/economic#shop-restrictions)。
- 支持的交易种类包括：
  + [销售](#shop-sell)
  + [收购](#shop-buy)
  + [抽奖](#shop-lottery)
- 玩家可以创建至多 8 个交易牌子。
- 玩家在自己的销售区可以使用 128 个物品槽。“抽奖”牌子不受此限制。
- 每次交易加收 2% 消费税。

#### 开始销售 :id=shop-sell

1. 对准一块空牌子，使用命令 `/hshop create sell [第3行文本（可选）] [第4行文本（可选）]`，即可创建销售木牌。  
1. 这时，再对该牌子执行命令 `/hshop sell [单价]`，即可上架手上的物品。

?> :information_source: **示例**  
如要以 9 节操的单价，出售 64 个石头，那么持有之并执行 `/hshop sell 9`，石头将全部上架。

你还可借助**物品展示框**出售商品。其将随机展示销售区商品，每 30 秒切换一次；同一商品至多被一个展示框选中。  
设置方法：

- 放置一个展示框，对准它使用命令 `/hframe set` 即可。
- 如需撤销，对准其执行命令 `/hframe remove`。

此外，召唤分身来帮你带货，也是可以的！只需站在指定位置并执行 `/npc hehshop` ！  
要撤销的话，对着你的分身执行 `/npc hehshop remove` 便可。

#### 开始收购 :id=shop-buy

1. 对准一块空牌子，使用命令 `/hshop create buy [第3行文本（可选）] [第4行文本（可选）]` 即可创建收购木牌。
1. 然后要选择一个箱子以存放收购所得物品。对准箱子执行 `/hchest req` 即可。
1. 最后，手中拿着要收购的物品，准星对着收购木牌，敲 `/hshop buy [单价]`。  
例如：以 9 节操/个收购石头，则手中拿着石头然后敲 `/hshop buy 9`

如果不想再用这个箱子，对准它敲命令 `/hchest remove`。
<!-- 如果忘记自己的存储箱在哪里，命令 `/h shop storage info`。 -->

#### 购买商品与响应收购

* 右键点击「出售」牌子即可打开商店界面。单击购买一个，按住 Shift 单击则购买一整个槽。
* 对于卖家本人，以上操作会下架该商品。


* 对于展示框商店，对其按右键即可购买一个。在该商品售罄前，你仍可继续点击购买，直至其切换所示商品。


* 右键点击「收购」牌子可查询该木牌所收购的物品明细。
* 手持相应物品，对准该木牌**左键**点击，即可出售给收购方。

#### 抽奖 :id=shop-lottery

1. 对准一块空牌子，使用命令 `/hshop create lotto [单价] [简短描述（可选）]`，即可创建抽奖木牌。
1.然后要选择一个箱子作为奖池。对准其使用命令 `/hchest lotto`，即可设置。  
（如果不想再用这个箱子，对准它敲命令 `/hchest remove`。）

顾客可右键点击 Lotto 木牌，即支付所示费用并随机获得奖池中的一个槽的物品。**注意：交易结果自负，交易前请三思！**

#### 全网搜索

现已支持在喵窝世界范围内搜索天喵木牌商店（含出售、收购）的物品。

?> :game_die: **用法**

`/hsearch 关键词 [选项:值]`

**可用选项：**

* `i` 或 `item`：物品名称或 ID，仅搜索指定物品
* `p` 或 `player`：玩家 ID，仅搜索指定玩家
* `r` 或 `range`：搜索范围，仅搜索指定距离内有木牌的商店
* `a` 或 `advanced`：高级搜索选项：
  * `ench`：搜索包括附魔
    * `enchonly`：仅搜索附魔
    * `lore`：搜索包括描述
    * `loreonly`：仅包括描述 选项间用 `|` 并列，如 `ench|lore`

?> :heavy_check_mark: **以上参数组合范例**

在所有木牌商店中，查找带有『经验修补』附魔的附魔书：  
`/hsearch SILK_TOUCH i:enchanted_book a:ench`

若搜索结果多于 1 页，可使用 `/hsearch page [页码]` 命令翻页。

!> 如何定位到卖家的店铺位置？

搜索结果会显示卖家 ID，但不提供定位。请参照民间制作的《[万华街店铺导览图](https://docs.qq.com/sheet/DV2tHUkFJSkxoQkFp?tab=BB08J2)》找到卖家店铺。

--------

## 征购

#### 玩家发起征购

拿起希望征购的物品，使用命令 `/hreq [数量（整数）] [单价（整数）]` 可发起征购。

?> :information_source: **示例**  
以单价 1 节操征购 100 个白色羊毛，可以用 `/hreq 100 1`。

**小贴士：**

- 你的现金余额应不少于 **货款总额**；征购时，系统将暂扣货款，并在过程中付给卖家。
- 背包空间应充足，征购所得物品将直接存入背包。 
- 如未征得全部所需物品，未支出的节操将退回。

#### 玩家响应征购

出现 `[征购]` 提示时，如果手上有相同物品，可以使用 `/hsell [数量]` 卖出，并指定出售数量。  
如果不填写「数量」（即 `/hsell`），则视为全部卖出，直至征购量已满为止。

--------

## 拍卖

#### 玩家发起拍卖

手中拿着要竞拍的物品（可堆叠），执行 `/hauc [起步价（整数）] [步进价（整数）] [保留价（整数、可选）]`。

如果成功卖出，买家获得该物品并支付相应的节操，系统则征收 10% 的消费税，也就是买家最终会支付出价节操的 **110%**；而卖家可以获得完整的出价节操。  
如因未能达到保留价，或者无人竞拍而流拍，物品会退回你的背包。

?> :information_source: **示例**  
要拍卖钻石 2 颗，则在手中拿着 2 颗；希望以**总价** 100 节操起步，每次出价至少比上次高 10 节操，敲 `/hauc 100 10` 即可。  
如果还希望成交价最低 150 节操，则使用 `/hauc 100 10 150`。

#### 玩家竞价

聊天栏出现`[拍卖]`提示时，可以使用 `/hbid [价格]` 来出价。  
如果不填写价格（即`/hbid`），可跟进当前允许的最低出价。`/hbid min` 同样有效。

?> :computer: 有时，聊天栏会弹出**无发起者**的拍卖广播。只有当「系统余额」陷入负值，服务器才会自动发起此类拍卖，直至回笼足够节操为止。  
请注意所拍卖的物品不一定适用于当前版本。

--------

## 天喵直送

天喵直送是全新的交易模式。交易只有买卖双方参与，内容不会泄露给第三者，双方利益与隐私被全面保护。双方在任意时刻、地点皆可“面交”，大大提升便利性。

#### 出售物品并发送账单

手持所售物品，使用命令 `/hsellto [玩家 ID] [总价]`，则将物品**全部**出售。  
使用后，物品立即暂存于系统，并向目标玩家发送账单。

#### 支付或取消账单

玩家在线时，如接收到新账单，会立即在聊天栏提示，并附带唯一的“账单 ID”。按提示使用命令 `/hpay [账单 ID]` 即可**支付并收货**。<br />
每次支付加征 2% 消费税。

收到账单后可予以取消。只需使用命令 `/hcancel [账单 ID]`。

!> 事实上，任何人（包括卖家）皆可支付任意账单，只要知道它的 ID。
